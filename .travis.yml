language: ruby
rvm: 2.5.1
services: postgresql
bundler_args: "--without production -j4"
cache: bundler
before_script:
  - bundle exec rake db:create
  - bundle exec rake db:migrate
script: bundle exec rake test
deploy:
  provider: heroku
  api_key:
    secure: oAqCRwAs2ILK09L1kEzRMv5wWlpThCkkelLVFLwJ6+j5o3yWbDf+5b4lQ2EOWl3Q4u0RMjCxOdBbfYGadHQJ/cXsuPfBV+HBpix88BNG438GMueoN38hcsBQkodMKZwge0i2gChNBJDY2BAeNWL4tqx64+fRXejdRCOBfm4i5Lu6dvncvPCHvx1wTGR/hlyUce/1FwkbWYRcmbZALo3P8yubaSdGLOm0RyDBVPS0vNFNZSiIr51tlhILyGGpdO6v+iMVOoojnCInFFzRQmMimUwfwpuIKgt1exJDhzj3+flNUMVdmKuZU9YbMHnUf/mY6J5MGvNORxLdmC9Y7oPbtgToYeHi9bHgriUxfZOfmuu02S6RH0vd+vSrYbg4QtfH4TBk6JtbKumBuNiZ5Dxnn8HWH4cc5AA48g8EgzKvmJhqtykzdNlPxwBsJcKqs45lQFujOdS4VHQ8ruDPcUeJDKl6f0bvqQ9rS7+tNdqcOAQDzVCJ1wGSrjd6yGe4Q17DR90AQamwxjOIKYadqNJ+XmFHh0KPjsMXX/BDroUZPSIAJGek+vsWkdwve7fOgRIhdHQ3uy2rMDjZnq31oHHIAyUV4zrXwXyOV8/BWlsXCYnDImGvDxHZgd6UP37XFY4hxlXivkQKa2JC+CGVEnZxC0D4jsD/Yd4MYbROg3977oo=
  app: ydmsample-201901-stage
  on:
    repo: yosi-q/ydmsample-201901
  run:
    - bundle exec rake db:migrate
    - bundle exec rake cleanup
notifications:
  slack:
    rooms:
      - secure: "BZFjOAr2vEjzRCeNQCe0WkSVIeH1X0WCI511zkQAFf4+NlHKhwC4s87HDw6nIPIU09gU9vvm/7PCW88Xobsq/2emCyQ2lJl3dnRmzgAM/A1UakdRzG/TLKrvvRsChh0RRAdu4itOpxcznnSPXCfoGENgwL/XjA/pZET7T0XU7/romZ9DvcyOZMJ8CRRpHmiYePlgLI3aB3kx/tccKMLeo1wWcnYudA2NXZtJKaOB54/UWe8MSy6L902MNHri7hzAGbSCqvzNUYrCs2U1qYSlF0gpfbrIPNWDYex90i6qwxjTF/cAzlmfujSPpGYVCaDcJ+P3R/LJWKKDhvEGjA87uBNC+vFdwhl2jwRY5XW+fFcGTQrPDsvVzvu6hC+5lmFkKC0d3uvYchjwvEAZVEORdNnDS+MHiQYxd8hUVTowrwES4zGI4+4viRQyN0+La09jIeZ61tMBPYrSAhz/yNj9JcvSdRHs9a1lZ7fG8somB6ceZadTN6gOjIsQWFsfTfzNFPN+wPZRG90qJMejlZIGywk+Rbkd0KnGUUR0kGdW1jE4LIKqtbcBq29YtOh1iEnSCbwb9d/tH7Ne3QvWmNvd2iZHx/dKX6XS/RDPa6W5cM5VoF+4tLZ5WmXRa/2omK2V+6I3zeW2WK2uscpwOWlN+jEmejd8AtlYCuQLBJf3sks="
    on_success: always
    on_failure: always
    on_pull_requests: true
addons:
  code_climate:
    repo_token:
      secure: "og7DaHPdU3Kvqes17IuiuzDxz51RWCmiHMuIEypWuqB9R+mziDXQGYNydOZ4U5L2431wx3jMDa3krp9L6bfAIoFZtMwf4eJwOclzMXP8fRme6KwmhEVAJzd90QPUc0qUYR4mtG/WkxvKpHAv090U7+g9Ok/5p73r/M9Xs3UZeCbLVD9GqUMJc9IeKNL/yH0Jn9iqN+Y2X7VD/sE86PiXDD47+t3ECr1xgh+LOGklEaqkH3KLkQA7PBx78X7tOEPOR7Ceojnmwjm5VNi/3tJBK3qjDVAo+vqxux1Ovn9ytSs4vySKVsjfInIbcqT0xKiUAgWIdx8O5Fx2Vdubv50e8dQXGAu7BhO63Fp3FhkaAxgpT+xQQ9RhH6YRFP3HoV/6fwFfU2SDYm45YlwgGrHR9yRjH9sMOfSS8oMrY3zJWiRFIeSHSjjznNtKp/xKoBRtUAZqJDcxoREIw3jHXy9quF1chVoKHw+r9Cr/SkBd4apDJvHBlDuVhIB6/CVlew0XmHnRlBIwTaNNadCT4T4hGNjQNv2EmtDkjxSPxrDHXR6xeomiSWZF3009hUZQ584xe5bIgCWspVi6KL4PVieglrzNxhvTTwzfpReUdyRECeFGsd22PvRCzaJEoa8z7IJW5Za2G2jJAWuZRrLvWK0Nr8Q88xlO7SWTRx+5Iggzmy8="
